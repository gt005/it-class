{% extends 'tacks_education_system/tacks_education_system_base_template.html' %}
{% load static %}

{% block main %}
    <section>
        <div class="tasks-list-page__level-block">
            <h4 class="tasks-list-page__level-block__level-header">
                Уровень
            </h4>
            <div class="tasks-list-page__level-block__level-progress">
                <div class="pre-level level">
                    <img src="{% static 'images/task-list-page-done-level.svg' %}"
                         alt="done">
                    <span>{{ level|add:"-1" }}</span>
                </div>
                <hr class="level-line done">
                <div class="current-level level">
                    <img src="{% static 'images/task-list-page-done-level.svg' %}"
                         alt="done">
                    <span>{{ level }}</span>
                </div>
                <hr class="level-line">
                <div class="next-level level">
                    <img src="{% static 'images/task-list-page-not-done-level.svg' %}"
                         alt="not done">
                    <span>{{ level|add:"1" }}</span>
                </div>
            </div>
        </div>
    </section>

    <section>
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-12">
                    <h4 class="tasks-list-page__active-task-header">
                        Активная задача
                    </h4>
                </div>
                <div class="col-12">
                    <a class="active-task-about-container" href="active_task/">
                        <div class="active-task-about-container__theme-name">
                            <span>Задача на тему: “Функции”</span>
                        </div>
                        <table class="table table-borderless">
                            <thead>
                            <tr>
                                <th scope="col">Время начала</th>
                                <th scope="col">Время завершения</th>
                                <th id="tasks-list-page__active-task__time-to-start-label" scope="col">До начала</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td id="tasks-list-page__active-task__start-time">28 окт 2020, 15:00:00</td>
                                <td>28 окт 2020, 18:00:00</td>
                                <td id="tasks-list-page__active-task__time-amount">
                                    1
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </a>

                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block detail_active_active_task %}active{% endblock %}

{% block scripts_include %}

    <script>
        let reminderTimeTaskListPage = document.querySelector('#tasks-list-page__active-task__time-amount'),
            taskListActiveTaskStartLabel = document.querySelector('#tasks-list-page__active-task__start-time'),
            taskListActiveTaskTimeToStartLabel = document.querySelector('#tasks-list-page__active-task__time-to-start-label'),
            taskListActiveTaskAboutContainer = document.querySelector('.active-task-about-container');

        function startCountdownOnActiveTask() {
            taskListActiveTaskStartLabel.textContent = "Началось";
                taskListActiveTaskTimeToStartLabel.textContent = "До конца";
                reminderTimeTaskListPage.textContent = '{{ active_task_period }}';
                taskListActiveTaskAboutContainer.classList.add('task-actived');
                remainderTimeCounter(
                    reminderTimeTaskListPage,
                    "Задача закроется через минуту",
                    function_on_end=undefined,
                    message_type=false,
                    red_color_toggle=true,
                    set_red_end_message=true,
                    end_message_alert="Задача закрылась, ее решение теперь нельзя отправлять.",
                    end_message_alert_type=false,
                );
        }

        remainderTimeCounter(
            reminderTimeTaskListPage,
            "Задача откроется через минуту",
            function_on_end=startCountdownOnActiveTask,
            message_type=true,
            red_color_toggle=false,
            set_red_end_message=false,
            end_message_alert="Задача открылась, можно начать решать.",
            end_message_alert_type=true,
        );
    </script>

{% endblock %}